(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[38973],{433528:(e,t,r)=>{"use strict";r.d(t,{gJ:()=>n,Oj:()=>o,jp:()=>i,CM:()=>a,DU:()=>l,aO:()=>s,v6:()=>u,K8:()=>c,IN:()=>p,zh:()=>f,AH:()=>d,Ub:()=>y,_9:()=>m,JB:()=>b,oh:()=>h,AY:()=>g,yi:()=>v,SW:()=>E,Hk:()=>O,iQ:()=>F,dY:()=>S,$:()=>w,_u:()=>P,gG:()=>j,DI:()=>T,dZ:()=>C,qw:()=>x,f$:()=>R,bZ:()=>D,$O:()=>_,sF:()=>I,Gk:()=>N,vO:()=>A,ut:()=>q,MK:()=>L,VV:()=>G,B8:()=>U,VM:()=>k,a3:()=>M,Xp:()=>B,DA:()=>Z,sK:()=>V,yA:()=>W,r:()=>z,iB:()=>H,WB:()=>Q,EH:()=>Y,Yd:()=>$,Hg:()=>X,Lz:()=>J,ye:()=>K,Jb:()=>ee,d:()=>te,fT:()=>re,Ib:()=>ne,Pl:()=>oe,UB:()=>ie,Uh:()=>ae,QT:()=>le,oL:()=>se,Ap:()=>ue,KD:()=>ce,Z_:()=>pe,Vw:()=>fe,sY:()=>de,kA:()=>ye,gr:()=>me,pX:()=>be,F5:()=>he,MO:()=>ge,dq:()=>ve,DY:()=>Ee,oO:()=>Oe,uF:()=>Fe,a8:()=>Se,Pv:()=>we,an:()=>Pe,lg:()=>je,nY:()=>Te,nG:()=>Ce,lx:()=>xe,$S:()=>Re,gc:()=>De,Uz:()=>_e,fO:()=>Ie,$E:()=>Ne,cE:()=>Ae,JK:()=>qe,YV:()=>Le,t9:()=>Ge,YG:()=>Ue,HT:()=>ke,MY:()=>Me,ve:()=>Be,hB:()=>Ze,Ox:()=>Ve,zd:()=>We,aT:()=>ze,VH:()=>He,Yb:()=>Qe,Jr:()=>Ye,pP:()=>$e,gL:()=>Xe});var n="FEATUREGRID:SET_UP",o="FEATUREGRID:SELECT_FEATURES",i="FEATUREGRID:DESELECT_FEATURES",a="FEATUREGRID:CLEAR_SELECTION",l="FEATUREGRID:SET_SELECTION_OPTIONS",s="FEATUREGRID:TOGGLE_MODE",u="FEATUREGRID:TOGGLE_FEATURES_SELECTION",c="FEATUREGRID:FEATURES_MODIFIED",p="FEATUREGRID:NEW_FEATURE",f="FEATUREGRID:SAVE_CHANGES",d="FEATUREGRID:SAVING",y="FEATUREGRID:START_EDITING_FEATURE",m="FEATUREGRID:START_DRAWING_FEATURE",b="FEATUREGRID:DELETE_GEOMETRY",h="FEATUREGRID:DELETE_GEOMETRY_FEATURE",g="FEATUREGRID:SAVE_SUCCESS",v="FEATUREGRID:CLEAR_CHANGES",E="FEATUREGRID:SAVE_ERROR",O="FEATUREGRID:DELETE_SELECTED_FEATURES",F="SET_FEATURES",S="FEATUREGRID:SORT_BY",w="FEATUREGRID:SET_LAYER",P="QUERY:UPDATE_FILTER",j="FEATUREGRID:CHANGE_PAGE",T="FEATUREGRID:GEOMETRY_CHANGED",C="DOCK_SIZE_FEATURES",x="FEATUREGRID:TOGGLE_TOOL",R="FEATUREGRID:CUSTOMIZE_ATTRIBUTE",D="ASK_CLOSE_FEATURE_GRID_CONFIRM",_="FEATUREGRID:OPEN_GRID",I="FEATUREGRID:CLOSE_GRID",N="FEATUREGRID:CLEAR_CHANGES_CONFIRMED",A="FEATUREGRID:FEATURE_GRID_CLOSE_CONFIRMED",q="FEATUREGRID:SET_PERMISSION",L="FEATUREGRID:DISABLE_TOOLBAR",G="FEATUREGRID:ACTIVATE_TEMPORARY_CHANGES",U="FEATUREGRID:DEACTIVATE_GEOMETRY_FILTER",k="FEATUREGRID:ADVANCED_SEARCH",M="FEATUREGRID:ZOOM_ALL",B="FEATUREGRID:INIT_PLUGIN",Z="FEATUREGRID:SIZE_CHANGE",V="FEATUREGRID:TOGGLE_SHOW_AGAIN_FLAG",W="FEATUREGRID:HIDE_SYNC_POPOVER",z="FEATUREGRID:UPDATE_EDITORS_OPTIONS",H="FEATUREGRID:LAUNCH_UPDATE_FILTER_FUNC",Q="FEATUREGRID:SET_SYNC_TOOL",Y={EDIT:"EDIT",VIEW:"VIEW"},$="FEATUREGRID:START_SYNC_WMS",X="FEATUREGRID:STOP_SYNC_WMS",J="STORE_ADVANCED_SEARCH_FILTER",K="LOAD_MORE_FEATURES",ee="FEATUREGRID:QUERY_RESULT",te="FEATUREGRID:SET_TIME_SYNC",re="FEATUREGRID:SET_PAGINATION";function ne(){return{type:V}}function oe(){return{type:W}}function ie(e,t){return{type:ee,features:e,pages:t}}function ae(e){return{type:J,filterObj:e}}function le(){return{type:B,options:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}function se(){return{type:N}}function ue(){return{type:A}}function ce(e,t){return{type:o,features:e,append:t}}function pe(e){return{type:n,options:e}}function fe(e){return{type:T,features:e}}function de(){return{type:y}}function ye(){return{type:m}}function me(e){return{type:i,features:e}}function be(){return{type:b}}function he(e){return{type:h,features:e}}function ge(){return{type:a}}function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.multiselect,r=e.showCheckbox;return{type:l,multiselect:t,showCheckbox:r}}function Ee(e,t){return{type:S,sortBy:e,sortOrder:t}}function Oe(e,t){return{type:j,page:e,size:t}}function Fe(e){return{type:w,id:e}}function Se(e){return{type:P,update:e,append:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}function we(e,t){return{type:x,tool:e,value:t}}function Pe(e,t,r){return{type:R,name:e,key:t,value:r}}function je(){return{type:s,mode:Y.EDIT}}function Te(){return{type:s,mode:Y.VIEW}}function Ce(e,t){return{type:c,features:e,updated:t}}function xe(e){return{type:p,features:e}}function Re(){return{type:f}}function De(){return{type:g}}function _e(){return{type:O}}function Ie(){return{type:d}}function Ne(){return{type:v}}function Ae(){return{type:E}}function qe(){return{type:D}}function Le(){return{type:I}}function Ge(){return{type:_}}function Ue(e){return{type:L,disabled:e}}function ke(e){return{type:q,permission:e}}function Me(){return{type:k}}function Be(){return{type:M}}function Ze(){return{type:$}}function Ve(e,t){return{type:Z,size:e,dockProps:t}}var We=function(e){return{type:K,pages:e}},ze=function(e){return{type:G,activated:e}},He=function(e){return{type:U,deactivated:e}},Qe=function(e){return{type:te,value:e}},Ye=function(e){return{type:re,size:e}},$e=function(e){return{type:H,updateFilterAction:e}},Xe=function(e){return{type:Q,syncWmsFilter:e}}},838167:(e,t,r)=>{"use strict";r.d(t,{k9:()=>E,v0:()=>v,ZP:()=>F});var n=r(675263),o=r.n(n),i=r(124852),a=r.n(i),l=r(868195);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u.apply(this,arguments)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function d(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(d,e);var t,r,n,o,i=(n=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(n);if(o){var r=f(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i.apply(this,arguments)}return t=d,(r=[{key:"render",value:function(){return this.context.intl?a().createElement(l.FormattedDate,u({value:this.props.value},this.props.dateParams)):a().createElement("span",null,this.props.value&&this.props.value.toString()||"")}}])&&c(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(a().Component);d(m,"propTypes",{value:o().object,dateParams:o().object}),d(m,"contextTypes",{intl:o().object}),d(m,"defaultProps",{value:new Date});const b=m;var h=r(615402),g=r(805346),v=g.Z,E=h.Z,O=b;const F={Message:g.Z,HTML:E,DateFormat:O}},273849:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(867076),o=r(828878),i=r(49977),a=r.n(i);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p=(0,n.mapPropsStreamWithConfig)(o.Z);const f=(0,n.compose)((0,n.defaultProps)({dataStreamFactory:function(){return a().Observable.of({})}}),p((function(e){return e.take(1).switchMap((function(t){return t.dataStreamFactory(e.startWith(t),t)})).combineLatest(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u(u({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),e)}))})))},145869:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(124852),o=r.n(n),i=r(675263),a=r.n(i);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function p(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(p,e);var t,r,n,i,a=(n=p,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(n);if(i){var r=c(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function p(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),a.apply(this,arguments)}return t=p,(r=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),p}(o().Component);p(d,"propTypes",{disabled:a().bool,className:a().string,checked:a().bool,onChange:a().func,onClick:a().func}),p(d,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const y=d},112346:(e,t,r)=>{"use strict";r.d(t,{Z:()=>D});var n=r(124852),o=r.n(n),i=r(675263),a=r.n(i),l=r(757588),s=r(145869),u=r(80717),c=r(805346);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function m(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(l,e);var t,r,n,i,a=(n=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(n);if(i){var r=y(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){var e=this;return o().createElement(u.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},btnGroupProps:{style:{margin:10}},buttons:[{glyph:this.props.checked?"chevron-down":"chevron-left",visible:!0,tooltip:this.props.checked?o().createElement(c.Z,{msgId:"collapse"}):o().createElement(c.Z,{msgId:"expand"}),onClick:function(){return e.props.onClick(!e.props.checked)}}]})}}])&&f(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(o().Component);m(h,"propTypes",{checked:a().bool,onClick:a().func}),m(h,"defaultProps",{checked:!1,onClick:function(){}});const g=h;var v=r(282467),E=r(82110);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function j(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===O(t)?t:String(t)}var C=function(){return o().createElement(v.Z,{className:"square-button-sm no-border switch-error"},o().createElement(l.Glyphicon,{glyph:"exclamation-mark",className:"text-danger"}))},x=function(){return o().createElement("div",{className:"switch-loading"},o().createElement(E.Z,{size:"small"}))},R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(c,e);var t,r,n,i,a=(n=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(n);if(i){var r=P(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(this,e)});function c(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return j(w(e=a.call.apply(a,[this].concat(r))),"state",{}),e}return t=c,(r=[{key:"renderHeader",value:function(){var e=this,t=this.props.useToolbar?g:s.Z;return o().createElement("div",null,o().createElement("div",{className:"pull-left"},this.props.title||this.props.header),o().createElement("div",{className:"pull-right"},this.props.locked?null:o().createElement(t,{checked:this.props.expanded,onClick:function(t){e.props.onSwitch(t)}}),this.props.error?o().createElement(C,null):null,this.props.loading?o().createElement(x,null):null,this.props.buttons.length>0&&this.props.expanded&&o().createElement(u.Z,{btnDefaultProps:{className:"square-button-sm no-border"},buttons:this.props.buttons})))}},{key:"render",value:function(){return o().createElement(l.Panel,{className:"mapstore-switch-panel",collapsible:!0,expanded:this.props.expanded,defaultExpanded:this.props.defaultExpanded,header:this.renderHeader()},this.props.children)}}])&&F(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(o().Component);j(R,"propTypes",{header:a().node,title:a().oneOfType([a().string,a().node]),defaultExpanded:a().string,expanded:a().bool,onSwitch:a().func,locked:a().bool,buttons:a().array,loading:a().bool,error:a().any,errorMsgId:a().string,transitionProps:a().object,useToolbar:a().bool}),j(R,"defaultProps",{title:"",expanded:!1,onSwitch:function(){},locked:!1,buttons:[],useToolbar:!1});const D=R},202576:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(124852),o=r.n(n),i=r(180307),a=r.n(i),l=r(675263),s=r.n(l),u=r(757588),c=r(352595),p=r(950966);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function b(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(s,e);var t,r,n,i,l=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(n);if(i){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),l.apply(this,arguments)}return t=s,(r=[{key:"renderPopover",value:function(){return o().createElement(u.Popover,{id:this.props.id,placement:this.props.placement,positionLeft:this.props.left,positionTop:this.props.top,title:this.props.title},this.props.text)}},{key:"renderContent",value:function(){var e=this;return o().createElement(u.Glyphicon,{ref:function(t){e.target=t},className:"text-".concat(this.props.bsStyle),glyph:this.props.glyph})}},{key:"render",value:function(){var e=this,t=!0===this.props.trigger?["hover","focus"]:this.props.trigger;return o().createElement("span",{className:"mapstore-info-popover"},this.props.trigger?o().createElement(p.Z,{trigger:t,placement:this.props.placement,overlay:this.renderPopover()},this.renderContent()):[this.renderContent(),o().createElement(c.Z,{placement:this.props.placement,show:!0,target:function(){return a().findDOMNode(e.target)}},this.renderPopover())])}}])&&d(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(o().Component);b(g,"propTypes",{id:s().string,title:s().string,text:s().string,glyph:s().string,bsStyle:s().string,placement:s().string,left:s().number,top:s().number,trigger:s().oneOfType([s().array,s().bool])}),b(g,"defaultProps",{id:"",title:"",text:"",placement:"right",left:200,top:50,glyph:"question-sign",bsStyle:"info",trigger:["hover","focus"]});const v=g},353637:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>rn});var n=r(618446),o=r.n(n),i=r(675263),a=r.n(i),l=r(124852),s=r.n(l),u=r(171703),c=r(506806),p=r(12838),f=r(22222),d=r(782904),y=r(604206),m=r(690825),b=r(640512),h=r(580416),g=r(801550),v=r(807878),E=r(95797),O=r(893379),F=r.n(O),S=r(949469);F()(S.Z,{insert:"head",singleton:!1}),S.Z.locals;var w=r(472986),P=r.n(w),j=r(965539),T=r(805346),C=r(112346),x=r(757588),R=r(743129),D=r(200020),_=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).item;return s().createElement("span",null,e&&e.name?s().createElement(T.Z,{msgId:e.name}):null)};const I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.spatialOperations,r=void 0===t?[]:t,n=e.onChange,o=void 0===n?function(){}:n,i=e.value;return s().createElement(D.DropdownList,{valueField:"id",className:"geometry-operation-selector",onChange:o,data:r,valueComponent:_,value:i,itemComponent:_})};var N=r(531071),A=r(611847),q=r(202576);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.search,n=t.url;return(0,A.w0)(e,n)||(0,A.w0)(e,r&&r.url)},U=function(e){return(e||[]).filter((function(){return"BBOX"!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id}))},k=r(227361),M=r.n(k),B=r(313311),Z=r.n(B),V=r(49977),W=r.n(V),z=r(886850),H=r(378889),Q={"xsd:normalizedString":"string","xsd:string":"string","xsd:date":"date","xsd:dateTime":"date","xsd:date-time":"date-time","xsd:time":"time","xsd:decimal":"number","xsd:int":"number","xsd:integer":"number","xsd:long":"number","xsd:negativeInteger":"number","xsd:nonNegativeInteger":"number","xsd:nonPositiveInteger":"number","xsd:positiveInteger":"number","xsd:short":"number","xsd:unsignedLong":"number","xsd:unsignedInt":"number","xsd:unsignedShort":"number","xsd:number":"number","xsd:boolean":"boolean","xsd:double":"number","xsd:float":"number","xsd:array":"array"},Y=function(e){return M()(e,"featureTypes[0].properties").filter((function(e){return 0!==e.type.indexOf("gml:")&&Q[e.type]})).map((function(e){return{label:e.name,attribute:e.name,type:Q[e.type],valueId:"id",valueLabel:"name",values:[]}}))},$=r(867076),X=r(273849);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){te(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function te(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==J(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===J(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var re=function(e){return e.distinctUntilChanged((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).searchUrl===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).searchUrl})).switchMap((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.crossLayerExpanded?V.Observable.of(t):e.filter((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).crossLayerExpanded})).take(1)})).switchMap((function(e){var t=e.featureTypeName,r=e.searchUrl;return(0,z.ED)({layer:{name:t,url:r,search:{type:"wfs",url:r}}}).do((function(e){if(t=e,r=M()(t,"WFS_Capabilities.Filter_Capabilities.Scalar_Capabilities.ArithmeticOperators.Functions.FunctionNames.FunctionName"),!Z()(r,(function(){return"queryCollection"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})._})))throw new Error("nocrosslayerfunctionalities");var t,r})).map((function(){return{loadingCapabilities:!1}})).catch((function(e){return V.Observable.of({errorObj:e,loadingAttributes:!1,loadingCapabilities:!1,featureTypeProperties:[]})})).startWith({loadingCapabilities:!0})})).startWith({})},ne=function(e,t){return e.distinctUntilChanged((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer,t=void 0===e?{}:e,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).layer;return r&&t.name===(r&&r.name)})).filter((function(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer})).switchMap((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layer;return V.Observable.defer((function(){return(0,z.v$)({layer:e})})).do((function(e){var r=M()((0,H.findGeometryProperty)(e.data||{}),"name");r&&t("geometryName",r)})).map((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).data;return Y(void 0===e?{}:e)})).map((function(e){return{attributes:e,loadingAttributes:!1}})).startWith({loadingAttributes:!0}).catch((function(e){return V.Observable.of({errorObj:e,loadingAttributes:!1,featureTypeProperties:[]})}))})).catch((function(e){return V.Observable.of({errorObj:e,loadingAttributes:!1,loadingCapabilities:!1,featureTypeProperties:[]})})).startWith({})};const oe=(0,$.compose)((0,$.withPropsOnChange)(["crossLayerFilter"],(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).crossLayerFilter,t=void 0===e?{}:e;return{queryCollection:M()(t,"collectGeometries.queryCollection"),operation:M()(t,"operation"),distance:M()(t,"distance")}})),(0,$.withProps)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=void 0===t?[]:t,n=e.queryCollection,o=void 0===n?{}:n;return{layer:Z()(r,(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name===o.typeName}))}})),(0,$.withHandlers)({setQueryCollectionParameter:function(e){var t=e.setCrossLayerFilterParameter,r=void 0===t?function(){}:t;return function(e,t){r("collectGeometries.queryCollection[".concat(e,"]"),t),"typeName"===e&&r("collectGeometries.queryCollection.filterFields",[])}},updateLogicCombo:function(e){var t=e.setCrossLayerFilterParameter,r=void 0===t?function(){}:t;return function(e,t){return r("collectGeometries.queryCollection.groupFields",[{id:e,logic:t,index:0}])}},setOperation:function(e){var t=e.setCrossLayerFilterParameter,r=void 0===t?function(){}:t;return function(e){return r("operation",e)}}}),(0,$.defaultProps)({dataStreamFactory:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).setQueryCollectionParameter,r=void 0===t?function(){}:t;return re(e).combineLatest(ne(e,r),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ee(ee({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),e)})).startWith({})}}),X.Z);var ie=r(843614),ae=r(47805),le=r(282467),se=r(80717);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,me(n.key),n)}}function pe(e,t){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pe(e,t)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}function ye(e,t,r){return(t=me(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function me(e){var t=function(e,t){if("object"!==ue(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ue(t)?t:String(t)}var be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}(l,e);var t,r,n,i,a=(n=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=de(n);if(i){var r=de(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fe(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),ye(fe(t=a.call(this,e)),"getCurrentFilter",(function(){return{featureTypeName:t.props.featureTypeName,groupFields:t.props.groupFields,filterFields:t.props.sendFilters&&t.props.sendFilters.attributeFilter&&t.props.filterFields.filter((function(e){return(0,ae.checkOperatorValidity)(e.value,e.operator)}))||[],spatialField:t.props.sendFilters&&t.props.sendFilters.spatialFilter&&t.props.spatialField||{attribute:t.props.spatialField&&t.props.spatialField.attribute},pagination:t.props.pagination,filterType:t.props.filterType,ogcVersion:t.props.ogcVersion,sortOptions:t.props.sortOptions,crossLayerFilter:t.props.sendFilters&&t.props.sendFilters.crossLayerFilter&&(0,ae.setupCrossLayerFilterDefaults)(t.props.crossLayerFilter)||null,hits:t.props.hits}})),ye(fe(t),"isCurrentFilterChanged",(function(){var e=t.getCurrentFilter(),r={groupFields:e.groupFields,filterFields:e.filterFields,spatialField:e.spatialField,crossLayerFilter:e.crossLayerFilter},n=t.props.appliedFilter||{},i={groupFields:n.groupFields,filterFields:n.attributePanelExpanded&&n.filterFields||[],spatialField:n.spatialPanelExpanded&&n.spatialField||{attribute:t.props.spatialField&&t.props.spatialField.attribute},crossLayerFilter:n.crossLayerExpanded&&n.crossLayerFilter&&n.crossLayerFilter.operation?(0,ae.setupCrossLayerFilterDefaults)(n.crossLayerFilter):null};return!o()(r,i)})),ye(fe(t),"search",(function(){var e=t.getCurrentFilter();t.props.actions.onQuery(t.props.searchUrl,e,t.props.params),t.props.advancedToolbar&&t.props.actions.storeAppliedFilter()})),ye(fe(t),"reset",(function(){if(t.props.actions.onChangeDrawingStatus("clean","","queryform",[]),t.props.actions.onReset(),t.props.advancedToolbar){var e={featureTypeName:t.props.featureTypeName,groupFields:[],filterFields:[],spatialField:{attribute:t.props.spatialField&&t.props.spatialField.attribute},pagination:t.props.pagination,filterType:t.props.filterType,ogcVersion:t.props.ogcVersion,sortOptions:t.props.sortOptions,crossLayerFilter:null,hits:t.props.hits};t.props.actions.onQuery(t.props.searchUrl,e,t.props.params),t.props.advancedToolbar&&t.props.actions.storeAppliedFilter()}})),ye(fe(t),"restorePersistedFilter",(function(){t.props.actions.onRestoreFilter()})),t}return t=l,(r=[{key:"render",value:function(){var e=this,t=this.props.filterFields.filter((function(e){return e.exception})).length>0,r=this.props.allowEmptyFilter&&!this.props.advancedToolbar,n=this.props.filterFields.filter((function(e){return e.value||0===e.value})).length>0,i=(0,ae.isFilterEmpty)(this.props),a=(0,ae.isFilterEmpty)(this.props.appliedFilter),l=this.isCurrentFilterChanged(),u=n||this.props.spatialField.geometry||(0,ae.isCrossLayerFilterValid)(this.props.crossLayerFilter),c=!o()(this.props.appliedFilter,this.props.storedFilter),p=r||i&&this.props.appliedFilter&&!a,f=t||!this.props.toolbarEnabled||i&&!p||!i&&(!u||!l),d=this.props.emptyFilterWarning&&i&&l,y=this.props.advancedToolbar?"queryform.apply":this.props.queryBtnMsgId,m=[{tooltipId:d?"queryform.emptyfilter":y,disabled:f,noTooltipWhenDisabled:!0,glyph:this.props.advancedToolbar?"ok":this.props.queryBtnGlyph,className:d?"square-button-md showWarning":"square-button-md",id:"query-toolbar-query",onClick:this.search}];if(this.props.advancedToolbar){var b=!c||this.props.loadingError||l,h=!c||!this.props.storedFilter||!this.props.toolbarEnabled,g=!this.props.appliedFilter||this.props.appliedFilter&&a||!this.props.toolbarEnabled;m=m.concat([{tooltipId:"queryform.save",disabled:b,noTooltipWhenDisabled:!0,glyph:"floppy-disk",id:"query-toolbar-save",onClick:this.props.actions.onSaveFilter},{tooltipId:"queryform.discard",disabled:h,noTooltipWhenDisabled:!0,glyph:"undo",id:"query-toolbar-discard",onClick:this.restorePersistedFilter},{tooltipId:"queryform.reset",glyph:"clear-filter",noTooltipWhenDisabled:!0,id:"reset",disabled:g,onClick:this.reset}])}else m=[{tooltipId:"queryform.reset",glyph:"clear-filter",noTooltipWhenDisabled:!0,id:"reset",disabled:!this.props.toolbarEnabled,onClick:this.reset}].concat(m);return s().createElement("div",{className:"container-fluid query-toolbar"},s().createElement(se.Z,{btnDefaultProps:{bsStyle:"primary",className:"square-button-md",tooltipPosition:"bottom"},className:"queryFormToolbar row-fluid pull-right",buttons:m}),s().createElement(ie.Z,{show:!!this.props.showGeneratedFilter,bsSize:"large"},s().createElement(ie.Z.Header,null,s().createElement(ie.Z.Title,null,this.props.resultTitle)),s().createElement(ie.Z.Body,null,s().createElement("textarea",{style:{width:"862px",maxWidth:"862px",height:"236px",maxHeight:"236px"}},this.props.showGeneratedFilter)),s().createElement(ie.Z.Footer,null,s().createElement(le.Z,{style:{float:"right"},onClick:function(){return e.props.actions.onQuery(null,null)}},"Close"))))}}])&&ce(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(s().Component);ye(be,"propTypes",{filterType:a().string,params:a().object,filterFields:a().array,groupFields:a().array,spatialField:a().object,sendFilters:a().object,crossLayerFilter:a().object,toolbarEnabled:a().bool,searchUrl:a().string,showGeneratedFilter:a().oneOfType([a().bool,a().string]),featureTypeName:a().string,actions:a().object,ogcVersion:a().string,titleMsgId:a().string,queryBtnMsgId:a().string,resultTitle:a().string,queryBtnGlyph:a().string,pagination:a().object,sortOptions:a().object,hits:a().bool,allowEmptyFilter:a().bool,emptyFilterWarning:a().bool,appliedFilter:a().object,storedFilter:a().object,advancedToolbar:a().bool,loadingError:a().bool}),ye(be,"defaultProps",{sendFilters:{attributeFilter:!0,spatialFilter:!0,crossLayerFilter:!0},filterType:"OGC",params:{},groupFields:[],filterFields:[],spatialField:{},toolbarEnabled:!0,searchUrl:null,showGeneratedFilter:!1,featureTypeName:null,titleMsgId:"queryform.title",queryBtnMsgId:"queryform.query",resultTitle:"Generated Filter",queryBtnGlyph:"search",pagination:null,sortOptions:null,hits:!1,allowEmptyFilter:!1,emptyFilterWarning:!1,advancedToolbar:!1,loadingError:!1,actions:{onQuery:function(){},onReset:function(){},onChangeDrawingStatus:function(){},onSaveFilter:function(){},onRestoreFilter:function(){},storeAppliedFilter:function(){}}});const he=be;var ge=r(414293),ve=r.n(ge),Ee=r(576364),Oe=r(86638),Fe=r(838167),Se=r(794192),we=r(701469),Pe=r.n(we),je=r(828878),Te=r(59286),Ce=r(91175),xe=r.n(Ce),Re=r(950966),De=r(848384);function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Ie(){return Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ie.apply(this,arguments)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ue(n.key),n)}}function Ae(e,t){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ae(e,t)}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}function Ge(e,t,r){return(t=Ue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ue(e){var t=function(e,t){if("object"!==_e(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_e(t)?t:String(t)}var ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ae(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Le(n);if(o){var r=Le(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qe(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ge(qe(e=i.call.apply(i,[this].concat(r))),"state",{}),Ge(qe(e),"renderWithTooltip",(function(t){if(e.props.tooltip.customizedTooltip){var r=e.props.tooltip.customizedTooltip;return s().createElement(r,null,t)}var n=s().createElement(x.Tooltip,{id:e.props.tooltip.id},"this.props.tooltip.message");return s().createElement(Re.Z,{key:e.props.tooltip.overlayTriggerKey,placement:e.props.tooltip.placement,overlay:n},t)})),Ge(qe(e),"renderPagination",(function(){var t=e.props.pagination.firstPage,r=e.props.pagination.lastPage;return s().createElement("div",{className:"autocomplete-toolbar"},!t&&s().createElement(x.Glyphicon,{className:e.props.prevPageIcon,glyph:e.props.prevPageIcon,onClick:function(){return e.props.pagination.loadPrevPage()}}),!r&&s().createElement(x.Glyphicon,{className:e.props.nextPageIcon,glyph:e.props.nextPageIcon,onClick:function(){return e.props.pagination.loadNextPage()}}))})),Ge(qe(e),"renderField",(function(){var t,r={emptyList:function(){return e.props.busy?"Loading...":(0,Oe.S$)(e.context.messages,"queryform.attributefilter.autocomplete.emptyList")},open:(0,Oe.S$)(e.context.messages,"queryform.attributefilter.autocomplete.open"),emptyFilter:(0,Oe.S$)(e.context.messages,"queryform.attributefilter.autocomplete.emptyFilter")},n=[];e.props.data&&e.props.data.length>0&&(n=e.props.data.map((function(e){return e}))),e.props.pagination&&e.props.pagination.paginated&&n.length>0&&n.push((Ge(t={},e.props.textField,""),Ge(t,e.props.valueField,""),Ge(t,"disabled",!0),Ge(t,"pagination",e.renderPagination()),t));var o=!1,i=e.props.loading?[]:n,a=e.props.itemComponent,l=s().createElement(D.Combobox,{dropUp:e.props.dropUp,busy:e.props.busy,data:i,disabled:e.props.disabled,itemComponent:function(t){return s().createElement(a,Ie({textField:e.props.textField,valueField:e.props.valueField},t))},messages:e.props.messages||r,open:e.props.open,filter:!1,onChange:function(t){e.props.onChange(t,e.props.valueField),o=!0},onFocus:function(){return e.props.onFocus(e.props.data)},onSelect:function(t){var r=xe()(e.props.features.filter((function(r){return r.properties[e.props.valueField].toLowerCase()===t[e.props.valueField].toLowerCase()})));e.props.onSelect(t,r,e.props.srsName,e.props.style)},onToggle:function(t){var r=xe()(e.props.features.filter((function(t){return t.properties[e.props.valueField].toLowerCase()===e.props.selectedValue.toLowerCase()})));!t||e.props.selectedValue||e.props.selectedValue||o||e.props.onChange("",e.props.valueField),e.props.onToggle(t,r,e.props.pagination.currentPage),r&&!t&&e.props.onSelect(e.props.selectedValue,r,e.props.srsName,e.props.style),o=!1},textField:e.props.textField,valueField:e.props.valueField,value:e.props.selectedValue});return e.props.tooltip&&e.props.tooltip.enabled?e.renderWithTooltip(l):l})),e}return t=a,(r=[{key:"render",value:function(){var e=this.props.label?s().createElement("label",null,this.props.label):s().createElement("span",null);return s().createElement("div",{className:"autocompleteField"},e,this.renderField())}}])&&Ne(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s().Component);Ge(ke,"propTypes",{busy:a().bool,data:a().array,disabled:a().bool,dropUp:a().bool,features:a().array,filter:a().string,itemComponent:a().oneOfType([a().object,a().func]),label:a().string,loading:a().bool,messages:a().object,onChange:a().func,onFocus:a().func,onSelect:a().func,onToggle:a().func,onChangeDrawingStatus:a().func,style:a().style,open:a().bool,pagination:a().object,nextPageIcon:a().string,prevPageIcon:a().string,selectedValue:a().string,srsName:a().string,textField:a().string,tooltip:a().object,valueField:a().string}),Ge(ke,"contextTypes",{messages:a().object}),Ge(ke,"defaultProps",{dropUp:!1,features:[],filter:"",itemComponent:De.Z,loading:!1,label:null,pagination:{paginated:!0,firstPage:!1,lastPage:!1,loadPrevPage:function(){},loadNextPage:function(){}},nextPageIcon:"chevron-right",prevPageIcon:"chevron-left",onFocus:function(){},onToggle:function(){},onChange:function(){},onChangeDrawingStatus:function(){},onSelect:function(){},srsName:"EPSG:4326",textField:"label",tooltip:{customizedTooltip:void 0,enabled:!1,id:"",message:void 0,overlayTriggerKey:"",placement:"top"},valueField:"value"});const Me=ke;function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){We(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function We(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Be(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Be(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}(0,$.setObservableConfig)(je.Z);var ze=(0,$.mapPropsStreamWithConfig)(je.Z)((function(e){return e.take(1).switchMap((function(t){return t.autocompleteStreamFactory(e)})).combineLatest(e,(function(e,t){return Ve(Ve({},t),{},{data:Pe()(e&&e.fetchedData&&e.fetchedData.values)?e.fetchedData.values:[],features:Pe()(e&&e.fetchedData&&e.fetchedData.features)?e.fetchedData.features:[],valuesCount:e&&e.fetchedData&&e.fetchedData.size,srsName:e&&e.fetchedData&&e.fetchedData.crs,busy:e.busy})}))}))((function(e){var t=e.open,r=e.toggle,n=e.select,o=e.focus,i=e.change,a=e.changed,l=e.originalValue,u=e.value,c=e.valuesCount,p=e.onChangeDrawingStatus,f=e.loadNextPage,d=e.loadPrevPage,y=e.maxFeatures,m=e.currentPage,b=e.itemComponent,h=e.features,g=e.busy,v=e.data,E=e.loading,O=void 0!==E&&E,F=e.valueField,S=e.textField,w=e.filter,P=e.srsName,j=e.style,T=Math.ceil(c/y);return s().createElement(Me,{pagination:{firstPage:1===m,lastPage:T<=m,paginated:!0,loadPrevPage:d,loadNextPage:f,currentPage:m},srsName:P,busy:g,dropUp:!1,data:v,open:t,onChangeDrawingStatus:p,valueField:F,textField:S,itemComponent:b,filter:w,onFocus:o,onToggle:r,onChange:i,onSelect:n,features:h,style:j,selectedValue:a?u:l||u,loading:O})})),He=(0,$.compose)((0,$.withPropsOnChange)(["valueField"],(function(){return{value:void 0}})),(0,$.withStateHandlers)((function(e){return{delayDebounce:0,performFetch:!1,open:!1,currentPage:1,maxFeatures:5,changed:e.value,value:e.value,onChangeDrawingStatus:e.onChangeDrawingStatus,itemComponent:e.itemComponent}}),{select:function(){return function(e){return{selected:e}}},change:function(e){return function(t,r){return e.selected||e.open||e.onChangeDrawingStatus("clean","","queryform",[],{}),{delayDebounce:500,selected:!1,changingPage:!1,changed:!0,performFetch:!(e.selected&&!e.changingPage),value:e.selected&&e.changingPage&&e.value||("string"==typeof t?t:t[r]),currentPage:e.changingPage?e.currentPage:1}}},focus:function(e){return function(t){return t&&0===t.length&&""===e.value?{delayDebounce:0,currentPage:1,performFetch:!0,isToggled:!1,open:!0}:e}},toggle:function(e){return function(){return{open:!!e.changingPage||!e.open}}},loadNextPage:function(e){return function(){return{currentPage:e.currentPage+1,performFetch:!0,changingPage:!0,delayDebounce:0}}},loadPrevPage:function(e){return function(){return{currentPage:e.currentPage-1,performFetch:!0,changingPage:!0,delayDebounce:0}}}}),(0,$.withHandlers)({select:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,r=e.onChangeSpatialFilterValue,n=void 0===r?function(){}:r,o=e.select,i=void 0===o?function(){}:o;return function(e,r,o,a){r&&n({geometry:r.geometry,value:e,feature:r,srsName:o,style:a,options:t,collectGeometries:t&&t.crossLayer?{queryCollection:{typeName:t.crossLayer.typeName,geometryName:t.crossLayer.geometryName,cqlFilter:(0,Te.generateTemplateString)(t.crossLayer.cqlTemplate||"",ae.escapeCQLStrings)(r)}}:void 0}),i(!0)}}})),Qe=He(ze),Ye=r(704201);function $e(e){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$e(e)}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,et(n.key),n)}}function Je(e,t){return Je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Je(e,t)}function Ke(e){return Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ke(e)}function et(e){var t=function(e,t){if("object"!==$e(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==$e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===$e(t)?t:String(t)}var tt,rt,nt,ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Je(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(n);if(o){var r=Ke(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===$e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){return s().createElement("span",{className:this.props.customItemClassName?this.props.customItemClassName:""},this.props.item)}}])&&Xe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s().Component);tt=ot,rt="propTypes",nt={item:a().string,textField:a().string,customItemClassName:a().string,valueField:a().string},(rt=et(rt))in tt?Object.defineProperty(tt,rt,{value:nt,enumerable:!0,configurable:!0,writable:!0}):tt[rt]=nt;const it=ot;var at=r(727418),lt=r.n(at),st=r(986267);function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mt(n.key),n)}}function pt(e,t){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pt(e,t)}function ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}function yt(e,t,r){return(t=mt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mt(e){var t=function(e,t){if("object"!==ut(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ut(t)?t:String(t)}var bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dt(n);if(o){var r=dt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ut(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ft(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return yt(ft(e=i.call.apply(i,[this].concat(r))),"onUpdateBBOX",(function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace";"replace"===n&&(e.tempExtent[r]=!isNaN(parseFloat(t))&&parseFloat(t)||0);var o=[];for(var i in e.tempExtent)i&&o.push(e.tempExtent[i]);var a=(0,st.reprojectBbox)(o,"EPSG:4326",e.props.projection),l={type:e.props.geometry.type,coordinates:[[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]],[a[0],a[1]]]],projection:e.props.geometry.projection};e.props.onChangeDrawingStatus(n,void 0,"queryform",[l])})),yt(ft(e),"onUpdateCircle",(function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace";"replace"===n&&(e.tempCircle[r]=parseFloat(t));var o=isNaN(parseFloat(e.tempCircle.x))||isNaN(parseFloat(e.tempCircle.y))?[e.tempCircle.x,e.tempCircle.y]:(0,st.reproject)([e.tempCircle.x,e.tempCircle.y],"EPSG:4326",e.props.projection);o=void 0===o.x?{x:o[0],y:o[1]}:o;var i={x:isNaN(o.x)?0:o.x,y:isNaN(o.y)?0:o.y},a={type:e.props.geometry.type,center:i,coordinates:[i.x,i.y],radius:isNaN(e.tempCircle.radius)?0:e.tempCircle.radius,projection:e.props.geometry.projection};e.props.onChangeDrawingStatus(n,void 0,"queryform",[a],{geodesic:e.props.enableGeodesic})})),yt(ft(e),"onModifyGeometry",(function(){"BBOX"===e.props.type?e.onUpdateBBOX(null,null,"endDrawing"):"Circle"===e.props.type&&e.onUpdateCircle(null,null,"endDrawing"),e.props.onShowPanel(!1)})),yt(ft(e),"onClosePanel",(function(){e.resetGeom(),e.props.onShowPanel(!1)})),yt(ft(e),"getStep",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.min(1/Math.pow(10,Math.ceil(Math.min(e,21)/3)-2),1)})),yt(ft(e),"getStepCircle",(function(t,r){var n=e.getStep(t);return"radius"===r&&!e.isWGS84()&&1e4*n||n})),yt(ft(e),"getBBOXDimensions",(function(e){var t=(0,st.reprojectBbox)(e.extent,e.projection,"EPSG:4326");return{west:t[0],sud:t[1],est:t[2],north:t[3]}})),yt(ft(e),"getCircleDimensions",(function(t){var r=(0,st.reproject)(t.center,t.projection,"EPSG:4326"),n=(0,st.reproject)(t.center,t.projection,e.props.projection),o=(0,st.reproject)([t.center[0]+t.radius,t.center[1]],t.projection,e.props.projection),i=Math.sqrt((o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y));return{x:r.x,y:r.y,radius:i}})),yt(ft(e),"renderCoordinateField",(function(t,r){return s().createElement("div",null,s().createElement("div",{className:"detail-field-title"},r),s().createElement(Se.Z,{style:{minWidth:"105px",margin:"auto"},type:"number",id:"queryform_bbox_"+r,step:e.getStep(e.props.zoom),defaultValue:e.roundValue(t,1e6),onChange:function(t){return e.onUpdateBBOX(t,r)}}))})),yt(ft(e),"renderCircleField",(function(t,r){return s().createElement(Se.Z,{type:"number",id:"queryform_circle_"+r,defaultValue:e.roundValue(t,"radius"!==r||e.isWGS84()?1e6:100),step:e.getStepCircle(e.props.zoom,r),onChange:function(t){return e.onUpdateCircle(t,r)}})})),yt(ft(e),"renderDetailsContent",(function(){var t,r=e.props.geometry;if("BBOX"===e.props.type){var n=e.getBBOXDimensions(r);t=s().createElement("div",null,s().createElement("div",{className:"container-fluid"},s().createElement(x.Row,null,s().createElement(x.Col,{xs:4},s().createElement("span",null)),s().createElement(x.Col,{xs:4},e.renderCoordinateField(n.north,"north")),s().createElement(x.Col,{xs:4},s().createElement("span",null))),s().createElement(x.Row,null,s().createElement(x.Col,{xs:4},e.renderCoordinateField(n.west,"west")),s().createElement(x.Col,{xs:4},s().createElement("span",null)),s().createElement(x.Col,{xs:4},e.renderCoordinateField(n.est,"est"))),s().createElement(x.Row,null,s().createElement(x.Col,{xs:4},s().createElement("span",null)),s().createElement(x.Col,{xs:4},e.renderCoordinateField(n.sud,"sud")),s().createElement(x.Col,{xs:4},s().createElement("span",null)))),s().createElement("span",null,s().createElement("hr",{width:"90%"}),s().createElement("div",null,s().createElement("h5",null,s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.details.details_bbox_label"})))))}else if("Circle"===e.props.type){var o=e.getCircleDimensions(r),i=(0,st.getUnits)(e.props.projection);t=s().createElement("div",null,s().createElement("div",{className:"container-fluid"},s().createElement(x.Row,null,s().createElement(x.Col,{xs:2},s().createElement("span",null)),s().createElement(x.Col,{xs:2},s().createElement("span",{className:"details-circle-attribute-name"},"x:")),s().createElement(x.Col,{xs:4},e.renderCircleField(o.x,"x")),s().createElement(x.Col,{xs:4},s().createElement("span",null))),s().createElement(x.Row,null,s().createElement(x.Col,{xs:2},s().createElement("span",null)),s().createElement(x.Col,{xs:2},s().createElement("span",{className:"details-circle-attribute-name"},"y:")),s().createElement(x.Col,{xs:4},e.renderCircleField(o.y,"y")),s().createElement(x.Col,{xs:4},s().createElement("span",null))),s().createElement(x.Row,null,s().createElement(x.Col,{xs:2},s().createElement("span",null)),s().createElement(x.Col,{xs:2},s().createElement("span",{className:"details-circle-attribute-name"},s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.details.radius",msgParams:{unit:"degrees"===i?"":i}}),":")),s().createElement(x.Col,{xs:4},e.renderCircleField(o.radius,"radius")),s().createElement(x.Col,{xs:4},s().createElement("span",null)))),s().createElement("span",null,s().createElement("hr",{width:"90%"}),s().createElement("div",null,s().createElement("h5",null,s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.details.details_circle_label"})))))}return t})),yt(ft(e),"isWGS84",(function(){return"EPSG:4326"===e.props.projection})),yt(ft(e),"roundValue",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6;return Math.round(e*t)/t})),yt(ft(e),"resetGeom",(function(){"BBOX"===e.props.type?e.resetBBOX():"Circle"===e.props.type&&e.resetCircle()})),yt(ft(e),"resetBBOX",(function(){for(var t in e.extent)t&&(document.getElementById("queryform_bbox_"+t).value=e.roundValue(e.extent[t],1e6),e.onUpdateBBOX(e.extent[t],t))})),yt(ft(e),"resetCircle",(function(){document.getElementById("queryform_circle_radius").value=e.roundValue(e.circle.radius,100),e.onUpdateCircle(e.circle.radius,"radius"),document.getElementById("queryform_circle_x").value=e.roundValue(e.circle.x,e.isWGS84()?1e6:100),e.onUpdateCircle(e.circle.x,"x"),document.getElementById("queryform_circle_y").value=e.roundValue(e.circle.y,e.isWGS84()?1e6:100),e.onUpdateCircle(e.circle.y,"y")})),e}return t=a,(r=[{key:"componentDidMount",value:function(){var e=this.props.geometry;"BBOX"===this.props.type?(this.extent=this.getBBOXDimensions(e),this.tempExtent=lt()({},this.extent)):"Circle"===this.props.type&&(this.circle=this.getCircleDimensions(e),this.tempCircle=lt()({},this.circle))}},{key:"render",value:function(){var e=this;return s().createElement(C.Z,{buttons:[{key:"confirm",glyph:"ok",tooltipId:"confirm",onClick:function(){return e.onModifyGeometry()}},{key:"reset",tooltipId:"queryform.reset",glyph:"clear-filter",onClick:function(){return e.resetGeom()}},{key:"close",glyph:"1-close",onClick:function(){return e.onClosePanel(!1)}}],title:s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.details.details_header"}),locked:!0,expanded:!0,className:"details-panel",bsStyle:"primary"},this.renderDetailsContent())}}])&&ct(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s().Component);yt(bt,"propTypes",{useMapProjection:a().bool,geometry:a().object,type:a().string,onShowPanel:a().func,onChangeDrawingStatus:a().func,zoom:a().number,projection:a().string,enableGeodesic:a().bool}),yt(bt,"defaultProps",{useMapProjection:!0,geometry:null,type:null,onShowPanel:function(){},onChangeDrawingStatus:function(){}});const ht=bt;function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function vt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wt(n.key),n)}}function Et(e,t){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Et(e,t)}function Ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ft(e){return Ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ft(e)}function St(e,t,r){return(t=wt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wt(e){var t=function(e,t){if("object"!==gt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===gt(t)?t:String(t)}var Pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Et(e,t)}(l,e);var t,r,n,i,a=(n=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ft(n);if(i){var r=Ft(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===gt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ot(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return St(Ot(e=a.call.apply(a,[this].concat(r))),"state",{open:!1}),St(Ot(e),"getFilter",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"=",n={filterFields:[{attribute:e.props.searchAttribute,operator:r,value:t,type:"list"}]};return e.props.dependsOn&&(n.groupFields=[{id:1,logic:"AND",index:0}],n.filterFields[0].groupId=1,e.props.multivalue?(n.groupFields.push({id:2,logic:"OR",groupId:1,index:1}),e.props.dependsOn.value instanceof Array?e.props.dependsOn.value.forEach((function(t){n.filterFields.push({attribute:e.props.dependsOn.field,operator:e.props.dependsOn.operator||"=",value:t,groupId:2,type:"list"})})):n.filterFields.push({attribute:e.props.dependsOn.field,operator:e.props.dependsOn.operator||"=",value:e.props.dependsOn.value,groupId:2,type:"list"})):n.filterFields.push({attribute:e.props.dependsOn.field,operator:e.props.dependsOn.operator||"=",value:e.props.dependsOn.value,groupId:1,type:"list"})),(0,ae.toOGCFilter)(e.props.typeName,n,e.props.wfs,e.props.sort||{sortBy:e.props.searchAttribute,sortOrder:"ASC"})})),St(Ot(e),"changeZoneValue",(function(t,r,n){var o;e.setState({open:!1}),o=e.props.multivalue?{value:n.map((function(e){return e.id})),feature:n.map((function(e){return e.feature}))}:{value:[n],feature:[e.values.filter((function(e){return e.id===n}))[0].feature]},e.props.onChange(e.props.zoneId,o)})),e}return t=l,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.values&&!o()(this.props.values,e.values)&&e.values.length>0&&this.setState({open:!0})}},{key:"render",value:function(){var e=this;this.values=[],this.props.values&&this.props.values.length>0&&(this.values=this.props.values.map((function(t){var r=t;e.props.valueField.split(".").forEach((function(e){r=r?r[e]:null}));var n=t;return e.props.textField.split(".").forEach((function(e){n=n?n[e]:null})),{id:r,name:n,feature:t}})));var t=this.props.label?s().createElement("label",null,this.props.label):s().createElement("span",null),r=this.props.error;return r&&(r="object"!==gt(r)?r:r.status+" "+r.statusText+": "+r.data),s().createElement("div",{className:"zone-combo"},t,s().createElement(Ye.Z,{key:(new Date).getTime(),busy:this.props.busy,disabled:this.props.disabled,fieldRowId:this.props.zoneId,valueField:"id",textField:"name",fieldOptions:this.values,fieldValue:this.props.value,fieldName:"zone",fieldException:r,options:{defaultOpen:this.state.open},groupBy:this.props.groupBy?function(t){return t.feature.properties[e.props.groupBy]}:function(){},multivalue:this.props.multivalue,comboFilter:this.props.comboFilter,onSelect:this.props.onSelect,onUpdateField:this.changeZoneValue,onToggle:function(t){if(t&&(!e.props.values||e.props.values.length<1)){var r=e.getFilter(e.props.searchText,e.props.searchMethod);e.props.onSearch(!0,e.props.zoneId),e.props.onFilter(e.props.url,r,e.props.zoneId)}}}))}}])&&vt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(s().Component);St(Pt,"propTypes",{zoneId:a().number,url:a().string,typeName:a().string,wfs:a().string,busy:a().bool,values:a().array,value:a().oneOfType([a().object,a().number,a().string,a().array]),label:a().string,searchText:a().string,searchMethod:a().string,searchAttribute:a().string,sort:a().object,error:a().oneOfType([a().object,a().string]),comboFilter:a().oneOfType([a().bool,a().string,a().func]),groupBy:a().oneOfType([a().string,a().func]),multivalue:a().bool,open:a().bool,disabled:a().bool,dependsOn:a().object,valueField:a().string,textField:a().string,onSearch:a().func,onFilter:a().func,onChange:a().func,onSelect:a().func}),St(Pt,"contextTypes",{messages:a().object}),St(Pt,"defaultProps",{open:!1,zoneId:null,url:null,typeName:null,wfs:"1.1.0",busy:!1,values:[],value:null,valueField:null,textField:null,label:null,disabled:!1,error:null,searchText:"*",searchMethod:"ilike",searchAttribute:null,comboFilter:"contains",multivalue:!0,groupBy:null,onSearch:function(){},onFilter:function(){},onChange:function(){},onSelect:function(){}});const jt=Pt;function Tt(e){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(e)}function Ct(){return Ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ct.apply(this,arguments)}function xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nt(n.key),n)}}function Rt(e,t){return Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rt(e,t)}function Dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}function It(e,t,r){return(t=Nt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nt(e){var t=function(e,t){if("object"!==Tt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Tt(t)?t:String(t)}var At=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_t(n);if(o){var r=_t(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Dt(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return It(Dt(e=i.call.apply(i,[this].concat(r))),"getMethodFromId",(function(t){return Z()(e.props.spatialMethodOptions,(function(e){return e&&e.id===t}))||null})),It(Dt(e),"renderHeader",(function(){var t=(0,Oe.S$)(e.context.messages,"queryform.spatialfilter.spatial_filter_header");return s().createElement("span",null,s().createElement("span",{style:{cursor:"pointer"},onClick:e.props.actions.onExpandSpatialFilterPanel.bind(null,!e.props.spatialPanelExpanded)},t))})),It(Dt(e),"renderSpatialHeader",(function(){var t=e.getMethodFromId(e.props.spatialField.method);return s().createElement("div",null,s().createElement(x.Row,{className:"logicHeader inline-form filter-field-row filter-field-fixed-row"},s().createElement(x.Col,{xs:6},s().createElement("div",null,s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.filterType"}))),s().createElement(x.Col,{xs:6},s().createElement(Ye.Z,{itemComponent:function(t){return s().createElement(it,Ct({customItemClassName:e.getMethodFromId(t.item)&&e.getMethodFromId(t.item).customItemClassName||""},t))},fieldOptions:e.props.spatialMethodOptions.map((function(t){return(0,Oe.S$)(e.context.messages,t.name)||t.name})),placeholder:(0,Oe.S$)(e.context.messages,"queryform.spatialfilter.combo_placeholder"),fieldName:"method",fieldRowId:(new Date).getTime(),fieldValue:(0,Oe.S$)(e.context.messages,t?t.name:"")||t&&t.name||"",onUpdateField:e.updateSpatialMethod}))))})),It(Dt(e),"renderDwithin",(function(){return s().createElement(x.Row,{className:"container-fluid filter-field-fixed-row"},s().createElement(x.Col,{xs:6,className:"filter-text-desc"},s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.dwithin_label"})),s().createElement(x.Col,{xs:6},s().createElement(Se.Z,{type:"number",min:"0",defaultValue:"0",disabled:!e.props.spatialField.geometry,id:"queryform_dwithin_field",onChange:function(t){return e.props.actions.onChangeDwithinValue(t,name)}})))})),It(Dt(e),"renderZoneFields",(function(){return e.props.spatialField.method&&"ZONE"===e.props.spatialField.method&&e.props.spatialField.zoneFields&&e.props.spatialField.zoneFields.length>0?e.props.spatialField.zoneFields.map((function(t){return s().createElement(jt,{key:t.id,open:t.open,zoneId:t.id,url:t.url,typeName:t.typeName,wfs:t.wfs,busy:t.busy,label:t.label,values:t.values,value:t.value,valueField:t.valueField,textField:t.textField,searchText:t.searchText,searchMethod:t.searchMethod,searchAttribute:t.searchAttribute,sort:t.sort,error:t.error,disabled:t.disabled,dependsOn:t.dependson,groupBy:t.groupBy,multivalue:t.multivalue,onSearch:e.props.actions.zoneSearch,onFilter:e.props.actions.zoneFilter,onChange:e.props.actions.zoneChange})})):null})),It(Dt(e),"renderRoiPanel",(function(){var t=e.getMethodFromId(e.props.spatialField.method),r=t&&t.filterProps&&t.filterProps.valueField&&e.props.spatialField&&e.props.spatialField.value&&e.props.spatialField.value[t.filterProps.valueField];return s().createElement(x.Panel,null,s().createElement("div",{className:"container-fluid"},s().createElement(x.Row,{className:"filter-field-row filter-field-fixed-row"},s().createElement(x.Col,{xs:6},s().createElement("span",null,t&&t.name||t.id)),s().createElement(x.Col,{xs:6},s().createElement(Qe,{originalValue:r,key:e.props.spatialField.method,options:t,autocompleteStreamFactory:Ee.Vj,valueField:t&&t.filterProps&&t.filterProps.valueField,textField:t&&t.filterProps&&t.filterProps.valueField,url:t&&t.url,filter:"contains",onChangeSpatialFilterValue:e.props.actions.onChangeSpatialFilterValue,onChangeDrawingStatus:function(){var t;(t=e.props.actions).onChangeDrawingStatus.apply(t,arguments)},filterProps:t&&t.filterProps})))))})),It(Dt(e),"renderSpatialPanel",(function(t,r,n){return s().createElement(x.Panel,{className:"spatial-panel"},e.props.spatialMethodOptions.length>1?e.renderSpatialHeader():s().createElement("span",null),e.renderZoneFields(),e.props.spatialField.method&&e.getMethodFromId(e.props.spatialField.method)&&"wfsGeocoder"===e.getMethodFromId(e.props.spatialField.method).type?e.renderRoiPanel():null,e.props.spatialOperations.length>1?s().createElement(x.Panel,null,s().createElement("div",null,t),n&&"DWITHIN"===n.id?e.renderDwithin():null,s().createElement(x.Row,null,s().createElement(x.Col,{xs:12},r))):s().createElement("span",null))})),It(Dt(e),"renderButtons",(function(){var t=[],r=e.props.showDetailsButton&&e.props.spatialField.geometry&&(e.props.spatialField.method&&"BBOX"===e.props.spatialField.method||"Circle"===e.props.spatialField.method),n=e.props.spatialField.geometry&&e.props.spatialField.geometry.coordinates;return r&&t.push({glyph:"pencil",onClick:function(){return e.props.actions.onShowSpatialSelectionDetails(!0)},tooltipId:"queryform.spatialfilter.details.detail_button_label"}),n&&t.push({glyph:"clear-filter",tooltipId:"queryform.spatialfilter.remove",bsStyle:e.props.clearFilterOptions.buttonStyle,className:e.props.clearFilterOptions.className,onClick:function(){return e.resetSpatialFilter()}}),t})),It(Dt(e),"updateSpatialMethod",(function(t,r,n){e.props.actions.onShowSpatialSelectionDetails(!1);var o=e.props.spatialMethodOptions.filter((function(t){return n===((0,Oe.S$)(e.context.messages,t.name)||t.name)}))[0].id,i=e.getMethodFromId(o);if(e.props.actions.onSelectSpatialMethod(o,r),"wfsGeocoder"!==e.getMethodFromId(o).type)switch(o){case"ZONE":e.changeDrawingStatus("clean","","queryform",[]);break;case"Viewport":e.changeDrawingStatus("clean","","queryform",[]),e.props.actions.onSelectViewportSpatialMethod();break;default:e.changeDrawingStatus("start",o,"queryform",[],{geodesic:!!ve()(i.geodesic)||i.geodesic,stopAfterDrawing:!0})}else e.changeDrawingStatus("clean","","queryform",[])})),It(Dt(e),"updateSpatialOperation",(function(t,r,n){var o=e.props.spatialOperations.filter((function(t){return n===(0,Oe.S$)(e.context.messages,t.name)}))[0].id;e.props.actions.onSelectSpatialOperation(o,r)})),It(Dt(e),"resetSpatialFilter",(function(){e.changeDrawingStatus("clean","","queryform",[]),e.props.actions.onRemoveSpatialSelection(),e.props.actions.onShowSpatialSelectionDetails(!1)})),It(Dt(e),"changeDrawingStatus",(function(t,r,n,o,i){e.props.actions.onChangeDrawingStatus(t,void 0!==r?r:e.props.spatialField.method,n,o,i)})),e}return t=a,(r=[{key:"render",value:function(){var e=this,t=this.props.spatialOperations.filter((function(t){return e.props.spatialField.operation===t.id}))[0],r=s().createElement("span",null);"ZONE"!==this.props.spatialField.method&&"Viewport"!==this.props.spatialField.method&&this.getMethodFromId(this.props.spatialField.method)&&"wfsGeocoder"!==this.getMethodFromId(this.props.spatialField.method).type&&(r=this.props.spatialField.geometry?null:s().createElement("span",null,s().createElement("div",{className:"m-label m-caption text-center"},s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.draw_start_label"}))));var n=this.getMethodFromId(this.props.spatialField.method),o=this.props.showDetailsPanel?s().createElement(ht,{useMapProjection:this.props.useMapProjection,enableGeodesic:!!ve()(n.geodesic)||n.geodesic,geometry:this.props.spatialField.geometry,type:this.props.spatialField.method,onShowPanel:this.props.actions.onShowSpatialSelectionDetails,onChangeDrawingStatus:this.changeDrawingStatus,zoom:this.props.zoom,projection:this.props.projection}):s().createElement("span",null),i=s().createElement(x.Row,{className:"filter-field-row inline-form filter-field-fixed-row"},s().createElement(x.Col,{xs:6},s().createElement(Fe.ZP.Message,{msgId:"queryform.spatialfilter.geometric_operation"})),s().createElement(x.Col,{xs:6},s().createElement(Ye.Z,{fieldOptions:this.props.spatialOperations.map((function(t){return(0,Oe.S$)(e.context.messages,t.name)})),fieldName:"operation",fieldRowId:(new Date).getTime(),fieldValue:(0,Oe.S$)(this.context.messages,t?t.name:""),onUpdateField:this.updateSpatialOperation})));return s().createElement("div",{className:"query-filter-container"},this.props.withContainer?s().createElement(C.Z,{id:"spatialFilterPanel",header:this.renderHeader(),buttons:this.renderButtons(),collapsible:!0,expanded:this.props.spatialPanelExpanded,onSwitch:function(t){return e.props.actions.onExpandSpatialFilterPanel(t)}},this.renderSpatialPanel(i,r,t)):this.renderSpatialPanel(i,r,t),o)}}])&&xt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s().Component);It(At,"propTypes",{useMapProjection:a().bool,spatialField:a().object,spatialOperations:a().array,spatialMethodOptions:a().array,spatialPanelExpanded:a().bool,showDetailsButton:a().bool,clearFilterOptions:a().object,showDetailsPanel:a().bool,withContainer:a().bool,actions:a().object,zoom:a().number,projection:a().string}),It(At,"contextTypes",{messages:a().object}),It(At,"defaultProps",{useMapProjection:!0,spatialField:{},spatialPanelExpanded:!0,showDetailsButton:!0,clearFilterOptions:{className:"square-button-sm no-border",buttonStyle:"default"},showDetailsPanel:!1,withContainer:!0,spatialMethodOptions:[],spatialOperations:[],actions:{onExpandSpatialFilterPanel:function(){},onSelectSpatialMethod:function(){},onSelectSpatialOperation:function(){},onChangeSpatialFilterValue:function(){},onChangeDrawingStatus:function(){},onRemoveSpatialSelection:function(){},onShowSpatialSelectionDetails:function(){},onSelectViewportSpatialMethod:function(){},onChangeRegion:function(){},onChangeDwithinValue:function(){},zoneFilter:function(){},zoneSearch:function(){},zoneChange:function(){}}});const qt=At;function Lt(){return Lt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lt.apply(this,arguments)}var Gt=(0,r(617252).Z)((function(e){return s().createElement("div",Lt({className:"square-button pull-right no-border",style:{display:"flex"}},e),s().createElement(x.Glyphicon,{glyph:"exclamation-mark",className:"text-danger"}))}));const Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.loadingError,r=e.onToggleQuery,n=void 0===r?function(){}:r,o=e.buttonStyle,i=void 0===o?"default":o;return s().createElement("div",{className:"mapstore-block-width"},s().createElement(le.Z,{id:"toc-query-close-button",key:"menu-button",className:"square-button no-border",bsStyle:i,onClick:function(){return n()}},s().createElement(x.Glyphicon,{glyph:"arrow-left"})),t&&s().createElement(Gt,{popover:{text:s().createElement(T.Z,{msgId:"queryform.loadingError"})}})||s().createElement("div",{className:"square-button pull-right no-border",style:{display:"flex"}},s().createElement(x.Glyphicon,{glyph:"filter",className:"text-primary"})))};function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mt.apply(this,arguments)}function Bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zt(n.key),n)}}function Zt(e,t){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zt(e,t)}function Vt(e){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vt(e)}function Wt(e,t,r){return(t=zt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zt(e){var t=function(e,t){if("object"!==kt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===kt(t)?t:String(t)}var Ht=oe((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.crossLayerExpanded,n=void 0===r||r,o=t.spatialOperations,i=t.expandCrossLayerFilterPanel,a=void 0===i?function(){}:i,l=t.layers,u=void 0===l?[]:l,c=t.errorObj,p=t.loadingAttributes,f=t.loadingCapabilities,d=t.searchUrl,y=t.queryCollection,m=void 0===y?{}:y,b=t.attributes,h=void 0===b?[]:b,g=t.operation,v=t.updateLogicCombo,E=void 0===v?function(){}:v,O=t.resetCrossLayerFilter,F=void 0===O?function(){}:O,S=t.setOperation,w=void 0===S?function(){}:S,P=t.setQueryCollectionParameter,j=void 0===P?function(){}:P,D=t.addCrossLayerFilterField,_=void 0===D?function(){}:D,A=t.updateCrossLayerFilterField,k=void 0===A?function(){}:A,M=t.removeCrossLayerFilterField,B=void 0===M?function(){}:M,Z=t.toggleMenu,V=void 0===Z?function(){}:Z,W=m.typeName,z=m.geometryName,H=m.filterFields,Q=m.groupFields,Y=void 0===Q?[{id:1,logic:"OR",index:0}]:Q,$=u.filter((function(e){return!G(d,e)}));return s().createElement(C.Z,{loading:f,expanded:n&&!f&&!c,error:c,errorMsgId:"queryPanel",buttons:(e=W?[{glyph:"clear-filter",tooltipId:"queryform.crossLayerFilter.clear",onClick:function(){return F()}}]:[],function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),onSwitch:a,title:s().createElement(T.Z,{msgId:"queryform.crossLayerFilter.title"})},s().createElement(x.Row,{className:"inline-form filter-field-fixed-row"},s().createElement(x.Col,{xs:6},s().createElement("div",null,s().createElement(T.Z,{msgId:"queryform.crossLayerFilter.targetLayer"}),"",u.length&&$.length?s().createElement(q.Z,{bsStyle:"link",text:s().createElement(T.Z,{msgId:"queryform.crossLayerFilter.errors.layersExcluded"})}):null)),s().createElement(x.Col,{xs:6},s().createElement(R.ZP,{clearable:!1,disabled:f||!!c,isLoading:p,options:u.filter((function(e){return G(d,e)})).map((function(e){return{label:e.title||e.name,value:e.name}})),placeholder:s().createElement(T.Z,{msgId:"queryform.crossLayerFilter.placeholder"}),filter:"contains",value:W,onChange:function(e){j("typeName",e&&e.value)}}))),W&&z?s().createElement(x.Row,{className:"inline-form filter-field-fixed-row"},s().createElement(x.Col,{xs:6},s().createElement("div",null,s().createElement(T.Z,{msgId:"queryform.crossLayerFilter.operation"}))),s().createElement(x.Col,{xs:6},s().createElement(I,{value:g,onChange:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;return w(e)},spatialOperations:U(o)}))):null,W&&z&&g?s().createElement(x.Row,{className:"filter-field-fixed-row"},s().createElement(x.Col,{xs:12},s().createElement(N.Z,{dropUp:!0,autocompleteEnabled:!0,withContainer:!1,attributes:h,groupLevels:-1,filterFields:H,actions:{onUpdateLogicCombo:E,onAddFilterField:_,onUpdateFilterField:k,onRemoveFilterField:B,toggleMenu:V},groupFields:Y,filterField:!0}))):null)})),Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vt(n);if(o){var r=Vt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){if(""!==this.props.featureTypeError)return s().createElement("div",null,s().createElement(Ut,{onToggleQuery:this.props.controlActions.onToggleQuery}),s().createElement("div",{style:{margin:"0 auto","text-align":"center"}},this.props.featureTypeErrorText));var e=s().createElement("div",{className:"m-header"},this.props.header,s().createElement(he,{sendFilters:{attributeFilter:this.props.attributePanelExpanded,spatialFilter:this.props.spatialPanelExpanded,crossLayerFilter:this.props.crossLayerExpanded},params:this.props.params,filterFields:this.props.filterFields,groupFields:this.props.groupFields,spatialField:this.props.spatialField,toolbarEnabled:this.props.toolbarEnabled,searchUrl:this.props.searchUrl,showGeneratedFilter:this.props.showGeneratedFilter,featureTypeName:this.props.featureTypeName,ogcVersion:this.props.ogcVersion,filterType:this.props.filterType,actions:this.props.queryToolbarActions,resultTitle:this.props.resultTitle,pagination:this.props.pagination,sortOptions:this.props.sortOptions,crossLayerFilter:this.props.crossLayerFilterOptions.crossLayerFilter,hits:this.props.hits,allowEmptyFilter:this.props.allowEmptyFilter,emptyFilterWarning:this.props.emptyFilterWarning,appliedFilter:this.props.appliedFilter,storedFilter:this.props.storedFilter,advancedToolbar:this.props.advancedToolbar,loadingError:this.props.loadingError}));return this.props.attributes.length>0?s().createElement(j.Z,{header:e,className:"mapstore-query-builder",id:"query-form-panel"},s().createElement(N.Z,{buttonStyle:this.props.buttonStyle,removeGroupButtonIcon:this.props.removeGroupButtonIcon,autocompleteEnabled:this.props.autocompleteEnabled,maxFeaturesWPS:this.props.maxFeaturesWPS,attributes:this.props.attributes,groupLevels:this.props.groupLevels,filterFields:this.props.filterFields,groupFields:this.props.groupFields,removeButtonIcon:this.props.removeButtonIcon,addButtonIcon:this.props.addButtonIcon,attributePanelExpanded:this.props.attributePanelExpanded,actions:this.props.attributeFilterActions}),this.props.toolsOptions.hideSpatialFilter?null:s().createElement(qt,{useMapProjection:this.props.useMapProjection,spatialField:this.props.spatialField,clearFilterOptions:this.props.clearFilterOptions,spatialOperations:this.props.spatialOperations,spatialMethodOptions:this.props.spatialMethodOptions,showDetailsButton:this.props.showDetailsButton,spatialPanelExpanded:this.props.spatialPanelExpanded,showDetailsPanel:this.props.showDetailsPanel,actions:this.props.spatialFilterActions,zoom:this.props.zoom,projection:this.props.projection}),this.props.toolsOptions.hideCrossLayer?null:s().createElement(Ht,Mt({spatialOperations:this.props.spatialOperations,crossLayerExpanded:this.props.crossLayerExpanded,searchUrl:this.props.searchUrl,featureTypeName:this.props.featureTypeName},this.props.crossLayerFilterOptions,this.props.crossLayerFilterActions))):s().createElement("div",{style:{margin:"0 auto",width:"60px"}},s().createElement(P(),{spinnerName:"three-bounce",overrideSpinnerClassName:"spinner"}))}}])&&Bt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s().Component);Wt(Qt,"propTypes",{params:a().object,featureTypeConfigUrl:a().string,useMapProjection:a().bool,attributes:a().array,featureTypeError:a().string,featureTypeErrorText:a().node,groupLevels:a().number,maxFeaturesWPS:a().number,filterFields:a().array,groupFields:a().array,spatialField:a().object,removeButtonIcon:a().string,addButtonIcon:a().string,attributePanelExpanded:a().bool,showDetailsButton:a().bool,spatialPanelExpanded:a().bool,crossLayerExpanded:a().bool,showDetailsPanel:a().bool,toolbarEnabled:a().bool,searchUrl:a().string,showGeneratedFilter:a().oneOfType([a().bool,a().string]),filterType:a().string,featureTypeName:a().string,ogcVersion:a().string,attributeFilterActions:a().object,spatialFilterActions:a().object,queryToolbarActions:a().object,resultTitle:a().string,pagination:a().object,sortOptions:a().object,spatialOperations:a().array,spatialMethodOptions:a().array,crossLayerFilterOptions:a().object,crossLayerFilterActions:a().object,hits:a().bool,clearFilterOptions:a().object,buttonStyle:a().string,removeGroupButtonIcon:a().string,maxHeight:a().number,allowEmptyFilter:a().bool,autocompleteEnabled:a().bool,emptyFilterWarning:a().bool,header:a().node,zoom:a().number,projection:a().string,toolsOptions:a().object,appliedFilter:a().object,storedFilter:a().object,advancedToolbar:a().bool,loadingError:a().bool,controlActions:a().object}),Wt(Qt,"defaultProps",{params:{},featureTypeConfigUrl:null,useMapProjection:!0,groupLevels:1,buttonStyle:"default",removeGroupButtonIcon:"trash",groupFields:[],filterFields:[],attributes:[],spatialMethodOptions:[],spatialOperations:[],featureTypeError:"",spatialField:{},crossLayerFilter:null,removeButtonIcon:"trash",addButtonIcon:"glyphicon glyphicon-plus",attributePanelExpanded:!0,spatialPanelExpanded:!0,showDetailsPanel:!1,toolbarEnabled:!0,searchUrl:"",showGeneratedFilter:!1,featureTypeName:null,pagination:null,sortOptions:null,hits:!1,maxHeight:830,allowEmptyFilter:!1,autocompleteEnabled:!0,emptyFilterWarning:!1,advancedToolbar:!1,loadingError:!1,attributeFilterActions:{onAddGroupField:function(){},onAddFilterField:function(){},onRemoveFilterField:function(){},onUpdateFilterField:function(){},onUpdateExceptionField:function(){},onUpdateLogicCombo:function(){},onRemoveGroupField:function(){},onChangeCascadingValue:function(){},onExpandAttributeFilterPanel:function(){}},spatialFilterActions:{onExpandSpatialFilterPanel:function(){},onSelectSpatialMethod:function(){},onSelectSpatialOperation:function(){},onChangeDrawingStatus:function(){},onRemoveSpatialSelection:function(){},onShowSpatialSelectionDetails:function(){},onSelectViewportSpatialMethod:function(){},onChangeDwithinValue:function(){}},crossLayerFilterOptions:{},crossLayerFilterActions:{},queryToolbarActions:{onQuery:function(){},onReset:function(){},onChangeDrawingStatus:function(){},onSaveFilter:function(){},onRestoreFilter:function(){}},toolsOptions:{},controlActions:{onToggleQuery:function(){}}});const Yt=Qt;var $t=r(399534),Xt=r(694745),Jt=r(410240),Kt=r.n(Jt),er=r(375875),tr=r.n(er),rr=r(197395),nr=r(284069),or=r(737275),ir=r(824260),ar=r(469842),lr=r(788113);const sr={isAutoCompleteEnabled:function(e,t){return e.ofType(E.S0).switchMap((function(e){var r=(0,or.y9)(e.url,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:"gs:PagedUnique"},(0,lr.kS)(t.getState()));return null===r?W().Observable.of((0,v.NV)(!1)):W().Observable.fromPromise(tr().post(r,null,{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}}).then((function(e){return e.data}))).switchMap((function(e){return Kt()(e,"<ows:ExceptionReport")?W().Observable.of((0,v.NV)(!1)):W().Observable.of((0,v.NV)(!0))})).catch((function(){return W().Observable.of((0,v.NV)(!1))}))}))},fetchAutocompleteOptionsEpic:function(e,t){return e.ofType(v.l1,v.nh).debounce((function(e){return W().Observable.timer(e.fieldOptions.delayDebounce||0)})).filter((function(e){return"value"===e.fieldName&&"string"===e.fieldType&&t.getState().queryform.autocompleteEnabled})).switchMap((function(e){var r,n,o,i,a,l,s=t.getState(),u=(0,ar.Vx)(s),c={};if(c=e.type===v.nh?(null===(o=s.queryform.crossLayerFilter)||void 0===o||null===(i=o.collectGeometries)||void 0===i||null===(a=i.queryCollection)||void 0===a||null===(l=a.filterFields)||void 0===l?void 0:l.filter((function(t){return t.rowId===e.rowId}))[0])||{}:s.queryform&&s.queryform.filterFields&&s.queryform.filterFields.filter((function(t){return t.rowId===e.rowId}))[0],"selected"===e.fieldOptions.selected)return W().Observable.from([e.type===v.nh?(0,v.ln)(c,[],0):(0,v.$J)(c,[],0)]);var p=(0,nr.getWpsPayload)({attribute:c.attribute,layerName:e.type===v.nh?null===(r=s.queryform.crossLayerFilter)||void 0===r||null===(n=r.collectGeometries)||void 0===n?void 0:n.queryCollection.typeName:(0,ir.HY)(s),layerFilter:(0,ar.Vc)(s)||(0,ar.hI)(s),maxFeatures:u,startIndex:e.fieldOptions.currentPage?e.fieldOptions.currentPage-1:1*u,value:e.fieldValue}),f=(0,or.y9)(s.query.url,{outputFormat:"json"},(0,lr.kS)(t.getState()));return null===f?W().Observable.of((0,v.NV)(!1)):W().Observable.fromPromise(tr().post(f,p,{timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/xml"}}).then((function(e){return e.data}))).switchMap((function(t){var r=Pe()(t.values)?t.values:[t.values],n=t.size;return W().Observable.from(e.type===v.nh?[(0,v.ln)(c,r,n),(0,v.js)(e.rowId,!0,"crossLayer")]:[(0,v.$J)(c,r,n),(0,v.js)(e.rowId,!0,"filterField")])})).startWith((0,v.jR)(!0,c,e.type===v.nh?"crossLayer":"filterField")).catch((function(){return W().Observable.from([e.type===v.nh?(0,v.ln)(c,[],0):(0,v.$J)(c,[],0),(0,rr.vU)({title:"warning",message:"warning",action:{label:"warning"},autoDismiss:3,position:"tr"}),(0,v.js)(e.rowId,!0,e.type===v.nh?"crossLayer":"filterField")])})).concat([(0,v.jR)(!1,c,e.type===v.nh?"crossLayer":"filterField")])}))}};var ur=r(275982),cr=r(675110);function pr(e){return pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pr(e)}function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){yr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function yr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==pr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==pr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===pr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const mr={handleLayerFilterPanel:function(e,t){var r=t.getState;return e.ofType(b.Xs).switchMap((function(){var t=(0,cr.Iz)(r()),n=t||{},o=n.url,i=n.name,a=n.layerFilter,l=t&&t.search&&t.search.url;return W().Observable.of((0,E.gT)(l||o,i),(0,v.F)(a),(0,b.HH)(a),(0,d.Xg)("queryPanel","enabled",!0)).merge(W().Observable.of((0,E.jG)()).filter((function(){return!M()(r(),"query.isLayerFilter")})),e.ofType(v.Wm).switchMap((function(e){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.crossLayerFilter,r=e.spatialField,n=e.filterFields;return!!(n&&xe()(n)||r&&r.method&&r.operation&&r.geometry||t&&t.collectGeometries&&t.operation)}(e.filterObj)?dr({},M()(r(),"queryform",{})):void 0;return n&&(n.filterFields=n.attributePanelExpanded&&n.filterFields||[],n.spatialField=n.spatialPanelExpanded&&n.spatialField||null,n.crossLayerFilter=n.crossLayerExpanded&&(0,ae.setupCrossLayerFilterDefaults)(n.crossLayerFilter)||null),W().Observable.of(function(e,t){return(0,h.He)(e,{layerFilter:t})}(t.id,n))}))).let(function(e){return function(t){return t.takeUntil(e.ofType(d.kM).filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.control,r=e.property;return"queryPanel"===t&&(!r||"enabled"===r)})).merge(e.ofType(ur.nk)))}}(e)).concat(W().Observable.from([(0,E.jG)(),(0,v.mc)(),(0,y.Yf)("clean","","queryform",[],{})]))}))},restoreSavedFilter:function(e,t){var r=t.getState;return e.ofType(b.H1).switchMap((function(){var e={typeName:M()(r(),"state.query.typeName")},t=M()(r(),"state.query.url"),n=M()(r(),"layerFilter.persisted");return W().Observable.of((0,y.Yf)("clean","","queryform",[]),(0,v.F)(n),(0,v.yC)(t,n,e),(0,E.Xc)())}))},onApplyFilter:function(e,t){var r=t.getState;return e.ofType(b.MY).map((function(){var e=dr({},M()(r(),"queryform",{}));return(0,b.Xr)(e)}))}};var br=r(813292),hr=r.n(br);const gr={updateSpatialFilterValue:function(e){return e.ofType(v.Wi).switchMap((function(e){var t=e.feature,r=e.srsName,n=e.style,o=e.options;return V.Observable.of((0,y.Yf)("drawOrEdit",t.geometry.type,"queryform",[t],{editEnabled:!1,stopAfterDrawing:!0,featureProjection:r},n)).concat(t&&o&&o.autoZoom?[(0,g.Px)(hr()(t),r)]:[])}))}};var vr=r(800827),Er=r(472500),Or=r(731255),Fr=r(285148);function Sr(e){return Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sr(e)}function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(r),!0).forEach((function(t){jr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function jr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Sr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Sr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Sr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(r),!0).forEach((function(t){xr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Rr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rr(e){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rr(e)}var Dr=function(e){return{geometry:e.featureTypes[0].properties.filter((function(e){return 0===e.type.indexOf("gml:")})).map((function(e){return{label:e.name,attribute:e.name,type:"geometry",valueId:"id",valueLabel:"name",values:[]}})),original:e,attributes:Y(e)}};function _r(e){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r(e)}function Ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Nr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(r),!0).forEach((function(t){Ar(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ar(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==_r(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==_r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var qr={};var Lr=r(797301),Gr=r(146905),Ur=r(367306),kr=r(55105),Mr=r(624262),Br=r(481756);function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function Vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xr(n.key),n)}}function Wr(e,t){return Wr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wr(e,t)}function zr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hr(e){return Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hr(e)}function Qr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(r),!0).forEach((function(t){$r(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $r(e,t,r){return(t=Xr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xr(e){var t=function(e,t){if("object"!==Zr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Zr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Zr(t)?t:String(t)}var Jr=v.mc.bind(null,"query"),Kr=(0,u.connect)((function(e){return{useMapProjection:e.queryform.useMapProjection,groupLevels:e.queryform.groupLevels,groupFields:e.queryform.groupFields,filterFields:e.queryform.filterFields,attributes:e.query&&e.query.typeName&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes,featureTypeError:e.query&&e.query.typeName&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].error,spatialField:e.queryform.spatialField,showDetailsPanel:e.queryform.showDetailsPanel,toolbarEnabled:e.queryform.toolbarEnabled,attributePanelExpanded:e.queryform.attributePanelExpanded,autocompleteEnabled:e.queryform.autocompleteEnabled,crossLayerExpanded:e.queryform.crossLayerExpanded,crossLayerFilterOptions:Yr({layers:(0,ar.GK)(e),crossLayerFilter:(0,ar.qh)(e)},e.queryform.crossLayerFilterOptions||{}),maxFeaturesWPS:e.queryform.maxFeaturesWPS,spatialPanelExpanded:e.queryform.spatialPanelExpanded,featureTypeConfigUrl:e.query&&e.query.url,searchUrl:e.query&&e.query.url,featureTypeName:e.query&&e.query.typeName,ogcVersion:"1.1.0",params:{typeName:e.query&&e.query.typeName},resultTitle:"Query Result",showGeneratedFilter:!1,allowEmptyFilter:!0,emptyFilterWarning:!0,maxHeight:e.map&&e.map.present&&e.map.present.size&&e.map.present.size.height,zoom:((0,vr.Od)(e)||{}).zoom,projection:((0,vr.Od)(e)||{}).projection}}),(function(e){return{attributeFilterActions:(0,p.DE)({onAddGroupField:v.kQ,onAddFilterField:v.jW,onRemoveFilterField:v.JG,onUpdateFilterField:v.q$,onUpdateExceptionField:v.OZ,onUpdateLogicCombo:v.Nc,onRemoveGroupField:v.I5,onChangeCascadingValue:v.QL,toggleMenu:v.js,onExpandAttributeFilterPanel:v.I},e),spatialFilterActions:(0,p.DE)({onChangeSpatialFilterValue:v.uo,onExpandSpatialFilterPanel:v.ku,onSelectSpatialMethod:v.HT,onSelectViewportSpatialMethod:v.lg,onSelectSpatialOperation:v.VF,onChangeDrawingStatus:y.Yf,onRemoveSpatialSelection:v.Ry,onShowSpatialSelectionDetails:v.ZH,onChangeDwithinValue:v.AQ,zoneFilter:v.eJ,zoneSearch:v.uM,zoneChange:v.uP},e),queryToolbarActions:(0,p.DE)({onQuery:v.yC,onReset:Jr,onSaveFilter:b.no,onRestoreFilter:b.Nd,storeAppliedFilter:b.Rb,onChangeDrawingStatus:y.Yf},e),crossLayerFilterActions:(0,p.DE)({expandCrossLayerFilterPanel:v.EU,setCrossLayerFilterParameter:v.IV,addCrossLayerFilterField:v.N5,updateCrossLayerFilterField:v.bn,removeCrossLayerFilterField:v.Bm,resetCrossLayerFilter:v.F2,toggleMenu:function(e,t){return(0,v.js)(e,t,"crossLayer")}},e),controlActions:(0,p.DE)({onToggleQuery:d.Xi.bind(null,"queryPanel",null)},e)}}))(Yt),en=(0,f.P1)([function(e){return e.controls&&e.controls.toolbar&&"toc"===e.controls.toolbar.active},cr.Bt,function(e){return e.layers&&e.layers.settings||{expanded:!1,options:{opacity:1}}},function(e){return e.controls&&e.controls.queryPanel&&e.controls.queryPanel.enabled||!1},function(e){return(0,kr.ic)(e,{height:!0})},Ur.Wy,ar.Vc,ar.hI,function(e){return e&&e.query&&e.query.isLayerFilter},cr.P_],(function(e,t,r,n,o,i,a,l,s,u){return{enabled:e,groups:t,settings:r,querypanelEnabled:n,layout:i?{}:o,appliedFilter:a,storedFilter:l,advancedToolbar:s,loadingError:u}})),tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wr(e,t)}(l,e);var t,r,n,i,a=(n=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Hr(n);if(i){var r=Hr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Zr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return zr(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),$r(zr(t=a.call(this,e)),"getNoBackgroundLayers",(function(e){return"background"!==e.name})),$r(zr(t),"renderSidebar",(function(){return s().createElement(c.Z,{open:t.props.querypanelEnabled,sidebar:t.renderQueryPanel(),sidebarClassName:"query-form-panel-container",touch:!1,styles:{sidebar:Yr(Yr({},t.props.layout),{},{zIndex:1024,width:600}),overlay:{zIndex:1023,width:0},root:{right:t.props.querypanelEnabled?0:"auto",width:"0",overflow:"visible"},content:{overflowY:"auto"}}},s().createElement("div",null))})),$r(zr(t),"onToggle",(function(){t.props.advancedToolbar&&!o()(t.props.appliedFilter,t.props.storedFilter)?t.setState((function(){return{showModal:!0}})):t.props.onToggleQuery()})),$r(zr(t),"restoreAndClose",(function(){t.setState((function(){return{showModal:!1}})),t.props.onRestoreFilter(),t.props.onToggleQuery()})),$r(zr(t),"storeAndClose",(function(){t.setState((function(){return{showModal:!1}})),t.props.onSaveFilter(),t.props.onToggleQuery()})),$r(zr(t),"renderQueryPanel",(function(){return s().createElement("div",{className:"mapstore-query-builder"},s().createElement(Kr,{header:s().createElement(Ut,{loadingError:t.props.loadingError,onToggleQuery:t.onToggle}),spatialOperations:t.props.spatialOperations,spatialMethodOptions:t.props.spatialMethodOptions,toolsOptions:t.props.toolsOptions,featureTypeErrorText:s().createElement(Br.Z,{msgId:"layerProperties.featureTypeError"}),appliedFilter:t.props.appliedFilter,storedFilter:t.props.storedFilter,advancedToolbar:t.props.advancedToolbar,loadingError:t.props.loadingError}),s().createElement($t.Z,null,s().createElement(Xt.Z,{fade:!0,show:t.state.showModal,title:s().createElement(Br.Z,{msgId:"queryform.changedFilter"}),size:"xs",onClose:function(){return t.setState((function(){return{showModal:!1}}))},buttons:[{bsStyle:"primary",text:s().createElement(Br.Z,{msgId:"yes"}),onClick:t.storeAndClose},{bsStyle:"primary",text:s().createElement(Br.Z,{msgId:"no"}),onClick:t.restoreAndClose}]},s().createElement("div",{className:"ms-alert"},s().createElement("div",{className:"ms-alert-center"},s().createElement(Br.Z,{msgId:t.props.loadingError?"queryform.changedFilterWithErrorAlert":"queryform.changedFilterAlert"}))))))})),t.state={showModal:!1},t}return t=l,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!0===e.querypanelEnabled&&!1===this.props.querypanelEnabled&&this.props.onInit()}},{key:"render",value:function(){return this.renderSidebar()}}])&&Vr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(s().Component);$r(tn,"propTypes",{id:a().number,buttonContent:a().node,groups:a().array,settings:a().object,querypanelEnabled:a().bool,groupStyle:a().object,groupPropertiesChangeHandler:a().func,layerPropertiesChangeHandler:a().func,onToggleGroup:a().func,onToggleLayer:a().func,onToggleQuery:a().func,onZoomToExtent:a().func,retrieveLayerData:a().func,onSort:a().func,onInit:a().func,onSettings:a().func,hideSettings:a().func,updateSettings:a().func,updateNode:a().func,removeNode:a().func,activateRemoveLayer:a().bool,activateLegendTool:a().bool,activateZoomTool:a().bool,activateSettingsTool:a().bool,visibilityCheckType:a().string,settingsOptions:a().object,layout:a().object,toolsOptions:a().object,appliedFilter:a().object,storedFilter:a().object,advancedToolbar:a().bool,onSaveFilter:a().func,onRestoreFilter:a().func}),$r(tn,"defaultProps",{groupPropertiesChangeHandler:function(){},layerPropertiesChangeHandler:function(){},retrieveLayerData:function(){},onToggleGroup:function(){},onToggleLayer:function(){},onToggleQuery:function(){},onZoomToExtent:function(){},onSettings:function(){},onInit:function(){},updateNode:function(){},removeNode:function(){},activateLegendTool:!0,activateZoomTool:!0,activateSettingsTool:!0,activateRemoveLayer:!0,visibilityCheckType:"checkbox",settingsOptions:{},querypanelEnabled:!1,layout:{},toolsOptions:{},onSaveFilter:function(){},onRestoreFilter:function(){}});const rn={QueryPanelPlugin:(0,u.connect)(en,{groupPropertiesChangeHandler:h.WO,layerPropertiesChangeHandler:h.He,retrieveLayerData:m.k,onToggleGroup:(0,Mr.$0)("groups",h.bh),onToggleLayer:(0,Mr.$0)("layers",h.bh),onToggleQuery:d.Xi.bind(null,"queryPanel",null),onSort:(0,Mr.dD)(Mr.lD,h.MK),onSettings:h.RP,onInit:E.Xc,onZoomToExtent:g.Px,hideSettings:h.sF,updateSettings:h.VP,updateNode:h.tV,removeNode:h.ZF,onSaveFilter:b.no,onRestoreFilter:b.Nd})(tn),reducers:{queryform:Gr.Z,query:Lr.Z,layerFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.y6:return Nr(Nr({},qr),{},{persisted:t.filter,applied:t.filter});case b.H1:return Nr(Nr({},e),{},{applied:e.persisted});case b.g$:return Nr(Nr({},e),{},{applied:t.filter});case b.Xk:return Nr(Nr({},e),{},{persisted:e.applied});case v.Eg:return Nr(Nr({},e),{},{applied:void 0});default:return e}}},epics:Yr(Yr(Yr({featureTypeSelectedEpic:function(e,t){return e.ofType(E.S0).filter((function(e){return e.url&&e.typeName})).switchMap((function(e){var r=t.getState();if((0,ir.hk)(r,e.typeName)){var n=Dr((0,ir.qj)(r,e.typeName)),o=n.geometry[0]&&n.geometry[0].attribute?n.geometry[0].attribute:"the_geom";return W().Observable.of((0,E.rG)(e.typeName,n),(0,v.DD)(o),W().Scheduler.async)}var i=(0,Or.Li)(r);return i&&"vector"===i.type?W().Observable.defer((function(){return tr().get(e.url)})).map((function(t){var r={featureTypes:[t.data.featureTypes[0]]},n={geometry:r.featureTypes[0].properties.filter((function(e){return 0===e.name.indexOf("geometry")})).map((function(e){return e})),original:r,attributes:Y(r)},o=n.geometry[0]&&n.geometry[0].attribute?n.geometry[0].attribute:"the_geom",i=new Promise((function(e){e((0,v.DD)(o))})).then((function(){return new Promise((function(t){t((0,E.rG)(e.typeName,n))}))}));return W().Observable.defer((function(){return i}))})).mergeAll():W().Observable.defer((function(){return tr().get(or.ZP.filterUrlParams(e.url,(0,lr.kS)(t.getState()))+"?service=WFS&version=1.1.0&request=DescribeFeatureType&typeName="+e.typeName+"&outputFormat=application/json")})).map((function(t){if("object"===Rr(t.data)&&t.data.featureTypes&&t.data.featureTypes[0]){var r=Dr(t.data),n=r.geometry[0]&&r.geometry[0].attribute?r.geometry[0].attribute:"the_geom";return W().Observable.from([(0,v.DD)(n),(0,E.rG)(e.typeName,r)])}try{JSON.parse(t.data)}catch(t){return W().Observable.from([(0,E.t3)(e.typeName,"Error from WFS: "+t.message),rr.vU({title:"warning",message:"layerProperties.featureTypeErrorInvalidJSON",autoDismiss:3,position:"tc"})])}return W().Observable.from([(0,E.t3)(e.typeName,"Error: feature types are empty")])})).mergeAll().catch((function(t){return W().Observable.of((0,E.t3)(e.typeName,t.message||t.statusText))}))}))},wfsQueryEpic:function(e,t){return e.ofType(E.Qq).switchMap((function(r){var n,o,i,a,l=(i=(a=t.getState()).query&&a.query.featureTypes&&a.query.featureTypes[a.query.typeName]&&a.query.featureTypes[a.query.typeName].attributes&&a.query.featureTypes[a.query.typeName].attributes[0]&&a.query.featureTypes[a.query.typeName].attributes[0].attribute||null)?{sortBy:i,sortOrder:"A"}:{},s=(null==r||null===(n=r.filterObj)||void 0===n?void 0:n.sortOptions)||l,u=ir.b0.totalFeatures(t.getState()),c=or.ZP.filterUrlParams(r.searchUrl,(0,lr.kS)(t.getState())),p=(0,Or.Li)(t.getState()),f=(0,Or.lg)(t.getState()),d=null!=p?p:{},y=d.layerFilter,m=d.params,b=void 0===m?{}:m,g=null==b?void 0:b[Z()(Object.keys(b||{}),(function(){return"cql_filter"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase()}))],v="vector"===(null==p?void 0:p.type)?r.filterObj:(0,ae.mergeFiltersToOGC)({ogcVersion:"1.1.0"},g,f?y:null,r.filterObj),O=function(e,t,r){var n=(0,Or.u$)(r),o=(0,Fr.jo)({id:n},"time")(r),i=(0,cr.CA)(r,n)||{},a=M()(i,'params["time"]');if((0,Or.DK)(r)&&o&&a){var l=(0,Er.parse)(e)||{};return{url:(0,Er.format)(Pr(Pr({},l),{},{query:Pr(Pr({},l.query),{},{time:a})})),options:t}}return{url:e,options:t}}(c,r.queryOptions||{},t.getState()),F=O.url,S=O.options,w=Cr(Cr(Cr({},r.filterObj.pagination),{},{totalFeatures:u,sortOptions:s},S),{},{layer:p});return W().Observable.merge((0,z.Mc)(Cr(Cr({},p),{},{name:r.filterObj.featureTypeName||(null==p?void 0:p.name),search:Cr(Cr({},null!==(o=null==p?void 0:p.search)&&void 0!==o?o:{}),{},{url:F})}),v,w).map((function(e){return(0,E.w_)(e,r.searchUrl,r.filterObj,r.queryOptions,r.reason)})).catch((function(e){return W().Observable.of((0,E.Lm)(e))})).startWith((0,E.Fs)(!0)).concat(W().Observable.of((0,E.Fs)(!1)),W().Observable.of((0,h.kI)(null==p?void 0:p.id)))).takeUntil(e.ofType(E.VN))}))},viewportSelectedEpic:function(e,t){return e.ofType(v.On,g.pP).switchMap((function(e){var r=e.type===g.pP?e:(0,vr.Od)(t.getState());if((e.type===v.On||e.type===g.pP&&"Viewport"===(0,ar.BU)(t.getState()))&&r.bbox&&r.bbox.bounds&&r.bbox.crs){var n=Object.keys(r.bbox.bounds).reduce((function(e,t){return lt()({},e,xr({},t,parseFloat(r.bbox.bounds[t])))}),{});return W().Observable.of((0,v.ds)(st.default.getViewportGeometry(n,r.bbox.crs)))}return W().Observable.empty()}))},redrawSpatialFilterEpic:function(e,t){return e.ofType(E.R1).switchMap((function(){var e=t.getState(),r=(0,ar.vE)(e),n={type:"Feature",geometry:{type:(0,ar.a8)(e),coordinates:(0,ar.G$)(e)}},o=(0,ar.Nl)(e)?(0,y.Yf)("drawOrEdit",r.method||"","queryform",[n],{featureProjection:(0,ar.IM)(e),drawEnabled:!1,editEnabled:!1}):(0,y.Yf)("clean",r.method||"","queryform",[],{drawEnabled:!1,editEnabled:!1});return W().Observable.of(o)}))}},sr),gr),mr)}},481756:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(171703),o=r(805346);const i=(0,n.connect)((function(e){return{locale:e.locale&&e.locale.currentLocale,messages:e.locale&&e.locale.messages||[]}}))(o.Z)},949469:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(923645),o=r.n(n)()((function(e){return e[1]}));o.push([e.id,"",""]);const i=o}}]);